---
title: "Assignment 3"
author: "ALZ Alliance"
format:
  html:
    toc: true
execute: 
  warning: false
---

```{r}
#| echo: false

knitr::opts_chunk$set(
  eval = TRUE,
  message = TRUE,
  warning = TRUE,
  error = TRUE
)
```

```{r}
# Loading the required library
library(tidyverse)
library(janitor)
library(knitr)
library(kableExtra)
library(ggplot2)
library(ggtext)
```

## Data processing

```{r}
# loading the data 
startup_finance <- read_csv(here::here("data","Finance_and_Insurance.csv")) |> clean_names()
startup_food <- read_csv(here::here("data","Food_and_services.csv")) |> clean_names()
startup_health <- read_csv(here::here("data","Health_Care.csv")) |> clean_names()
startup_it <- read_csv(here::here("data","Information_Sector.csv")) |> clean_names()
startup_manufacture <- read_csv(here::here("data","Manufactures.csv")) |> clean_names()
startup_retail <- read_csv(here::here("data","Retail_Trade.csv")) |>  clean_names()
```

#### Combining dataset into one

```{r}
# combining the dataset into one

startup_combined <- bind_rows(
  startup_finance,
  startup_food,
  startup_health,
  startup_it,
  startup_manufacture,
  startup_retail
)
```

#### Data cleaning

-   Convert years of operation into `start_year` and `end_year`
-   Mutate a col for length of business
##### Convert `how_much_they_raised` into numeric
```{r convert funding}
startup_combined <- startup_combined |>
  mutate(funding_millions = str_extract(how_much_they_raised, "\\d+\\.?\\d*") |> as.numeric())
```

##### Remove duplicated rows

```{r find duplicated names and remove them}

# Find companies with multiple observations
duplicated_names <- startup_combined |> 
  count(name) |> 
  filter(n > 1) |> 
  pull(name)

# Take a look to pick out which rows to remove
startup_combined |> 
  mutate(id = row_number()) |> 
  filter(name %in% duplicated_names) |> 
  arrange(name)

# Handpicked the rows to remove
removed_rows <- c(264, 89, 175, 306, 66, 259)
startup_combined <- startup_combined |> 
  mutate(id = row_number()) |> 
  filter(!id %in% removed_rows)
```

#### Understanding Dataset

```{r adding table for data description}

variable_description <- tibble::tibble(
  Variable = c(
    "name", "sector", "years_of_operation", "what_they_did",
    "how_much_they_raised", "why_they_failed", "takeaway", "giants",
    "no_budget", "competition", "poor_market_fit", "acquisition_stagnation",
    "platform_dependency", "monetization_failure", "niche_limits", "execution_flaws",
    "trend_shifts", "toxicity_trust_issues", "regulatory_pressure", "overhype"
  ),
  Description = c(
    "Name of the startup",
    "Business sector or industry",
    "Number of years the startup operated",
    "Description of what the startup did",
    "Total funds raised before failure (if available)",
    "Primary reason for startup failure",
    "Key takeaway or lesson from the failure",
    "Whether the startup competed with major players",
    "Failed due to budget constraints",
    "Faced tough competition",
    "Did not fit well with market demand",
    "Growth plateaued or stagnated",
    "Depended heavily on external platforms",
    "Could not effectively monetize",
    "Had limited market potential",
    "Poor execution or management issues",
    "Impact of changing industry trends",
    "Trust or toxicity issues in the team",
    "Faced legal or regulatory hurdles",
    "Failure due to excessive hype or unrealistic expectations"
  )
)

# Display as a table
kbl(variable_description, caption = "Variable Descriptions for Startup Combined Dataset") |>
  kable_styling(bootstrap_options = c("striped", "hover", "condensed"), full_width = F)
```

## Executive Summary (Linh)

## Introduction (Linh)

## Methodology (Ayush)

**Linh's suggestion to put funding distribution in methodology**

```{r funding distribution by sector}
#| eval: false
#| label: fig-funding-distribution
#| fig-cap: Funding amount has a heavy right-skewed distribution, which is seen across all sectors. 

startup_combined |>
  ggplot(aes(x = sector, y = funding_millions)) +
  geom_violin(fill = "#2166ac") +
  labs(
    title = "Funding Raised by Sector",
    x = "Sector",
    y = "Funding Raised (Millions)"
  ) +
  theme_minimal(base_family = "sans") +
  theme(
    panel.grid = element_blank(),
    axis.text.x = element_text(angle = 45, hjust = 1)  )

```

Considering various funding rounds startups could fall into, we defined funding brackets such that each bracket represents one or a few funding stages startups normally undergo. Low-funded startups are those having raised less than $20M, which is likely to be what (pre-)seed early-staged startups achieve (source). Medium-funded startups are those having raised between $20M and $70M; they are likely to be Series A and B startups who has already validated the market and now raise fund for market expansion and revenue generation (source). High-funded startups are those having raised more than $70M - the amount a Series C startup often reaches; at which stage, they have been in operations for several years, already proved their business model and are now looking for international market expansion, initial public offering or an acquisition with private equity firm and investment bank (source).

## Results (Zul + Linh)

### Why startups fail (Linh)

#### Overall reason
```{r overall failure reasons}
col_pivot <- c("giants", "no_budget", "competition", "poor_market_fit", "acquisition_stagnation",
"platform_dependency", "monetization_failure", "niche_limits", "execution_flaws",
"trend_shifts", "toxicity_trust_issues", "regulatory_pressure", "overhype", "high_operational_costs")

col_pivot_labels <- c(
  giants = "Giants",
  no_budget = "No budget",
  competition = "Competition",
  poor_market_fit = "Poor market fit",
  acquisition_stagnation = "Acquisition stagnation",
  platform_dependency = "Platform dependency",
  monetization_failure = "Monetization failure",
  niche_limits = "Niche limits",
  execution_flaws = "Execution flaws",
  trend_shifts = "Trend shifts",
  toxicity_trust_issues = "Toxicity & trust issues",
  regulatory_pressure = "Regulatory pressure",
  overhype = "Overhype",
  high_operational_costs = "High operational costs"
)

failure_counts <- startup_combined |> 
  select(col_pivot) |> 
  mutate_all(~replace_na(., 0)) |> 
  pivot_longer(cols = col_pivot, names_to = "reason", values_to = "present") |> 
  group_by(reason) |> 
  summarise(count = sum(present)) |> 
  ungroup() |> 
  mutate(percent = (count/nrow(startup_combined))*100)
```

```{r plot overall failure reason}
#| label: fig-overall-reason
#| fig-cap: "The majority of startups failed due to intense competition, especially with giant players in the market."

failure_counts |> 
  ggplot(aes(x = reorder(reason, count), y = count)) +
  geom_bar(stat = "identity", fill = "#2166ac") +
  geom_text(aes(label = paste0(count, " (", round(percent, 1), "%", ")")), 
            hjust = -0.1,
            color = "black", size = 3) +
  coord_flip() +
  labs(title = "Count of Startups by Failure Reason",
    x = "Failure Reason",
    y = "Number of Startups",
    fill = "Sector") +
  scale_x_discrete(labels = col_pivot_labels) +
  theme_minimal() +
  theme(panel.grid = element_blank(),
    axis.text.x = element_blank())

```

#### Reasons by sector

```{r percentage of failures by sector}
#| label: fig-sector-percent
#| fig-cap: "Besides universal reasons of Competition and Giants, each sector carried their own set of reasons for startup failures."

sector_counts <- startup_combined |> 
  group_by(sector) |> 
  summarise(sector_counts = n()) |> 
  ungroup() 

sector_percent <- startup_combined |> 
  select(sector, col_pivot) |> 
  mutate_all(~replace_na(., 0)) |> 
  pivot_longer(cols = col_pivot, names_to = "reason", values_to = "present") |> 
  group_by(sector, reason) |> 
  summarise(company_fail_counts = sum(present, na.rm = TRUE)) |> 
  ungroup() |> 
  left_join(sector_counts, by = "sector") |> 
  mutate(percent_fail = (company_fail_counts/sector_counts)*100)

sector_percent |> 
  bind_rows(
    failure_counts |> 
      rename(company_fail_counts = count, percent_fail = percent) |> 
      mutate(sector = "All sector")
  ) |> 
  mutate(
    #sector = factor(sector, levels = c("All sector", sort(unique(sector)[unique(sector) != "All sector"]))),
    label = ifelse(sector == "All sector", paste0("**", round(percent_fail, 1), "**"), as.character(round(percent_fail, 1))),
    sector_fmt = ifelse(sector == "All sector", paste0("**", sector, "**"), as.character(sector))
  ) |> 
  ggplot(aes(x = reorder(reason, company_fail_counts), y = sector_fmt, fill = percent_fail)) +
  geom_tile(color = "white") +
  geom_richtext(aes(label = label), size = 3, fill = NA, label.color = NA) +
  coord_flip() +
  scale_fill_gradient(low = "#f0f0f0", high = "#2166ac", name = "% Failed") +
  scale_x_discrete(labels = col_pivot_labels) +
  theme_minimal() +
  labs(title = "Startup Failure Reasons by Sector",
       x = "Failure Reason",
       y = "Sector") +
  theme(
    axis.text.x = element_markdown(angle = 45, hjust = 1),  # enables bold in y-axis
    panel.grid = element_blank()
  )

```

Top reasons for startup failure is competition with market giants, cited by 70% of startups. Poor market fit, post-acquisition stagnation, and budget constraints are also common across all sectors.

Additionally, each sector demonstrates their unique challenges, for example: 

- In Accommodation and Food Services, 52% of startups failed due to high operational costs.
- In Healthcare, the main reasons were poor market fit, monetization failure, and execution flaws.
- In Manufacturing, 55% cited lack of budget, followed by 28% pointing to execution flaws.

#### Funding

```{r funding by reason}
#| label: fig-funding-reason
#| fig-cap: "While low-funded startup struggled with product-market fit and product scalability due to niche market, higher-funded ones faced challenged in monetization, business executitions and post-acquisition operations. "

startup_combined <- startup_combined |>
  mutate(funding_millions = str_extract(how_much_they_raised, "\\d+\\.?\\d*") |> as.numeric())

threshold <- quantile(startup_combined$funding_millions, probs = c(0.25, 0.5, 0.75), na.rm = TRUE)

startup_combined <- startup_combined |> 
  mutate(funding_group = cut(funding_millions, breaks = c(-Inf, 20, 70, Inf),   
        labels = c("Low (< $20M)", "Medium ($20M - $70M)", "High (> $70M)"))) 
        
funding_group_counts <- startup_combined |> 
  group_by(funding_group) |> 
  summarise(funding_group_counts = n())

funding_group_percent <- startup_combined |> 
  select(col_pivot, funding_group) |>
  pivot_longer(cols = col_pivot, names_to = "reason", values_to = "present") |> 
  group_by(reason, funding_group) |> 
  summarise(count = sum(present, na.rm = TRUE)) |> 
  ungroup() |> 
  left_join(funding_group_counts, by = "funding_group") |> 
  mutate(percent_fail = (count/funding_group_counts)*100) |> 
  filter(!is.na(funding_group))
  
funding_group_percent |>
  ggplot(aes(x = reorder(reason, percent_fail), y = percent_fail)) +
  geom_col(fill = "#2166ac") +
  geom_text(aes(label = paste0(round(percent_fail, 1), "%")), 
            hjust = -0.1, color = "black", size = 3) +
  coord_flip() +
  facet_wrap(~funding_group, ncol = 4) +
  scale_x_discrete(labels = col_pivot_labels) + 
  labs(title = "Startup Failure Reasons by Funding Group",
    x = "Failure Reason",
    y = "Failure Percentage") +
  theme_minimal(base_family = "sans") +
  theme(panel.grid = element_blank(),
    strip.text = element_text(face = "bold"),
    axis.text.y = element_text(face = "plain"),
    axis.text.x = element_blank()) +
  expand_limits(y = max(funding_group_percent$percent_fail) * 1.1)

```

Besides the universal attribution of competitive rivalries, startups faced distinct challenges depending on their funding levels. 

- Low-funded startups reported facing challenges in scalability limits to niche product (29%), product-market fit (26%) and budget limits (21%).
- While poor market fit was also a hurdle for medium-funded startups (19%), they faced bigger obstacles in post-acquisition stagnation (25%) and monetization (21%).
- Execution flaws (23%), acquisition stagnation (23%), budget limits (20%), monetization failures (16%) and trend shifts (16%) are primary contributors to failures among high-funded startups.

### Temporal analysis of start-up failures (Zul)

## Discussion, Recommendations and Conclusions (Zul + Linh)

### Discussion

#### Why startups fail (Linh)

Fierce competitions and pressures from giant players are seen in every corner of the market, contributing to the failure of more than 70% of reported startups. Acquisition stagnation, poor product-market fit, budget limits are other common reasons for start-up failures across sectors. These reasons are widely recognized across entrepreneurship literatures and industry reports (source).

Beyond these universal factors, there are sector-specific and funding-specific attributes for startup failures, presenting unique business practices at different marketplace and startup life cycle. 

**Differences in failure reason across sectors**

Each sector has a different mix of reasons on why their startups failed. 

Accommodation and Food services startups reported 52% of their failures were due to High operational costs, which is unsurprising given the industry nature of heavy overheads into physical sites, e.g., hotels, restaurant. High financial requirement is also seen in 24% of startups attributing No budget to their failures. 

Similarly, Health Care and Manufacturing require substantial upfront investments into product development, which was a major hurdle that left 40% of startups in Health Care and 55% of startups in Manufacturing out of business due to insufficient financial capability. 

Beyond financial shortages, Health Care startups struggled with product-market fit, monetization failure and business execution. This tells a story of difficulties getting close to and empathize with customers, probably due to the industry nature of data confidentiality, discouraging people to share their health status.

Unlike other sectors with a few dominant contributors to startup failures, those in Retail Trade reported a wide variety of reasons, spread evenly across all reason categories. The most promimant reason is Niche limits (33%), followed by Poor market fit (22%) and Execution flaws (22%). Combined with lower figures for Competition (49%), Retail Trade is characterised by numerous niches, yet, whether these niches are scalable enough to sustain a business remains uncertain to entrepreneurs. Such scalability problem also explains the financial and monetization challenges they had (19% respectively).

Both Finance and Insurance, and Information startups reported market competition and major players to be the primary reason for their failure, while budget limits or monetization challenges were not as considerable as other sectors. This means prolific revenue potential and low barriers to entry, especially financial capital, making the market competition more intense. 

**Differences in failure reason across funding levels**

Taking a closer look from the funding angle, there are fundamental differences in failure reasons across level of fundings. 

Low-funded (<$20M) startups are likely to overlap with early-staged startups, who often has only a proof-of-concept or minimal viable product, looking to raise funds for their product development and market validation. They are not yet knowledgeable of how their products fit into the market, which explains why they hit a wall with Poor market fit (26%) or Niche market limits (29%).

Medium-funded ($20M - $70M) startups are likely to be Series A and B, in which stages they are striving for market expansion and revenue generation. Therefore, reaching niche limits is no longer their challenge, but acquisition stagnation (25%), monetization failure (21%) and execution flaws (16%).

High-funded (>$70M) startups are likely to be a long-time Series C startups, who has proved their business model, hence, had less problems with product-market fit (11%) compared to low-funded ones and monetization (17%) compared to medium-funded ones. However, as the business grows, operation complicates and market evolves, they failed from execution flaws and operation stagnation post-acquisition (23%), limited budget (20%) and inability to transform themselves with market trend (16%). 

#### Temporal analysis of start-up failures (Zul)

### Implications & Recommendations

### Conclusions
